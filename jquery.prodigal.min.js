(function(c,d,f,a){var j={width:960,height:600,minWidth:960,minHeight:400,position:"center",fitToView:false,spaceFromEdge:35,overlay:{show:true,opacity:0.4,onclickClose:true},tpl:{overlay:'<div class="prodigal_overlay"></div>',wrapper:'      <div class="prodigal_wrapper">         <div class="prodigal_outer">           <div class="prodigal_inner">&nbsp;</div>         </div>       </div>',close:'<div class="prodigal_close"><div class="close_button"><div class="close_symbol">&#215;</div><a href="#">Close</a></div></div>',gallery:'      <div class="prodigal_gallery_wrapper">         <div class="prodigal_gallery_left"></div>         <div class="prodigal_gallery_right"></div>       </div>',sorter:'      <div class="prodigal_sorter"><select>         <option value="all">All</option>         <option value="images">Images</option>         <option value="videos">Videos</option>       </select></div>'},thumbs:{width:null,height:55},sources:{youtube:{matcher:/(youtube\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?(videoseries\?list=(.*)|[\w-]{11}|\?listType=(.*)&list=(.*)).*/i,url:"//www.youtube.com/embed/$3"},vimeo:{matcher:/(?:vimeo(?:pro)?.com)\/(?:[^\d]+)?(\d+)(?:.*)/,url:"//player.vimeo.com/video/$1"}},_overlay:null,_wrapper:null,_media:[],isActive:false,isOpen:false},b={init:function(l){l=c.extend(true,{},j,l);return this.each(function(){data=c(this).data("prodigal");if(!data){c(this).data("prodigal",l).on("click",b.open);}});},destroy:function(){return this.each(function(){var m=c(this),l=m.data("prodigal");c(d).unbind(".prodigal");l.tooltip.remove();m.removeData("prodigal");});},close:function(){j._wrapper.find(".prodigal_gallery_left iframe").remove();j._overlay.remove();j._wrapper.remove();j._overlay=null;j._wrapper=null;j.isActive=false;},open:function(o){o.preventDefault();if(j._wrapper!=null||j._overlay!=null){b.close();}opts=c.extend(true,{},j,c(this).data("prodigal"));if(j.isActive==false){j._overlay=c(opts.tpl.overlay).css({opacity:opts.overlay.opacity,display:opts.overlay.show?"block":"none"}).appendTo("body");j._wrapper=c(opts.tpl.wrapper).css({}).appendTo("body");if(opts.overlay.onclickClose){j._overlay.on("click",b.close);}var m=c(opts.tpl.close);j._wrapper.find(".prodigal_inner").html("").append(m);m.find(".close_button").on("click",i);var l=c(opts.tpl.gallery);l.find(".prodigal_gallery_right").append(c(opts.tpl.sorter).on("change",e));j._wrapper.find(".prodigal_inner").append(l);j._wrapper.data("prodigal",opts);var n=c(o.target);c(f).find(".prodigal-thumbs").each(function(q,s){var t,p=c(s).attr("href"),r=c(s);if(r.find("img").length>0){t=r.find("img").attr("src");}else{}image=c('            <div class="image_item"><a class="prodigal_thumb" href="'+p+'"><img src="'+t+'"/></a></div>           ');image.data("prodigal-media-type","image");c.each(opts.sources,function(u,w){var v=w.matcher.exec(p);if(v!=null){p=h(w.url,v,{});image.find("a").attr("href",p);image.data("prodigal-media-type","video");}});image.find("img").css({width:opts.thumbs.width!==null?opts.thumbs.width:"auto",height:opts.thumbs.height!==null?opts.thumbs.height:"auto"});j._wrapper.find(".prodigal_gallery_right").append(image.on("click",k));if(n.parents(".prodigal-thumbs").get(0)==c(s).get(0)){image.trigger("click");}j._media[q]=image;});console.log(j._media);if(j._wrapper.find(".prodigal_img_selected").length<=0){j._wrapper.find(".prodigal_gallery_right .prodigal_thumb").get(0).trigger("click");}}b.resize();j.isActive=true;},resize:function(){if(!j._wrapper){return;}opts=j._wrapper.data("prodigal");var r=g(),m=r[0]!="undefined"&&r[0]!=null?r[0]:0,l=r[1]!="undefined"&&r[1]!=null?r[1]:0;j._wrapper.css({top:l+opts.spaceFromEdge,left:m+opts.spaceFromEdge});if(opts.fitToView){j._wrapper.css({width:c(d).width()-(opts.spaceFromEdge*2),height:c(d).height()-(opts.spaceFromEdge*2)});if(parseInt(j._wrapper.css("width"))<opts.minWidth){j._wrapper.css({width:opts.minWidth});}if(parseInt(j._wrapper.css("height"))<opts.minHeight){j._wrapper.css({height:opts.minHeight});}}else{j._wrapper.css({width:opts.width,height:opts.height});switch(opts.position){case"center":j._wrapper.css({left:Math.max(0,((c(d).width()-j._wrapper.outerWidth())/2)+c(d).scrollLeft())});break;case"right":case"left":default:break;}}var p=j._wrapper.outerHeight(),q=j._wrapper.find(".prodigal_close").outerHeight(),o=j._wrapper.find(".prodigal_gallery_left img"),n=j._wrapper.find(".prodigal_gallery_left");n.css({height:(p-q)-(parseInt(n.css("paddingTop"))+parseInt(n.css("paddingBottom"))),lineHeight:p-q+"px",width:(j._wrapper.width()-j._wrapper.find(".prodigal_gallery_right").width())-(parseInt(n.css("paddingLeft"))+parseInt(n.css("paddingRight")))});o.css({height:o.height()>n.height()?n.height():o.height()});o.css({marginTop:((n.height())-o.outerHeight())/2});j._wrapper.find(".prodigal_gallery_left iframe").css({height:n.height(),lineHeight:n.height()+"px",width:n.width()});}},i=function(l){l.preventDefault();b.close();},k=function(m){m.preventDefault();c(".prodigal_img_selected").removeClass("prodigal_img_selected");c(this).addClass("prodigal_img_selected");if(c(this).data("prodigal-media-type")!==null&&c(this).data("prodigal-media-type")=="video"){var l=c('<iframe class="prodigal-iframe" scrolling="auto" frameborder="0" allowfullscreen="" mozallowfullscreen=""     			webkitallowfullscreen="" hspace="0" vspace="0"></iframe>');l.attr("src",c(this).find("a").attr("href"));j._wrapper.find(".prodigal_gallery_left").html("").append(l);b.resize();}else{j._wrapper.find(".prodigal_gallery_left").html("").append(c('<img class="prodigal_large_preview"/>').css({visibility:"hidden"}));j._wrapper.find(".prodigal_large_preview").load(function(){b.resize();c(this).css({visibility:"visible"});}).attr("src",c(this).find("a").attr("href"));}},e=function(){switch(c(this).find(":selected").val()){case"all":j._wrapper.find(".image_item").css({display:"block"});break;case"images":j._wrapper.find(".image_item").each(function(){if(c(this).data("prodigal-media-type")=="image"){c(this).css({display:"block"});}else{c(this).css({display:"none"});}});break;case"videos":j._wrapper.find(".image_item").each(function(){if(c(this).data("prodigal-media-type")=="video"){c(this).css({display:"block"});}else{c(this).css({display:"none"});}});break;}},h=function(l,m,n){n=n||"";if(c.type(n)==="object"){n=c.param(n,true);}c.each(m,function(o,p){l=l.replace("$"+o,p||"");});if(n.length){l+=(l.indexOf("?")>0?"&":"?")+n;}return l;};function g(){var m,l;if(self.pageYOffset){l=self.pageYOffset;m=self.pageXOffset;}else{if(f.documentElement&&f.documentElement.scrollTop){l=f.documentElement.scrollTop;m=f.documentElement.scrollLeft;}else{if(f.body){l=f.body.scrollTop;m=f.body.scrollLeft;}}}return new Array(m,l);}c(d).resize(function(){b.resize();});c(f).on("keypress",function(l){if(l.keyCode==27){b.close();}});c.fn.prodigal=function(l){if(b[l]){return b[l].apply(this,Array.prototype.slice.call(arguments,1));}else{if(typeof l==="object"||!l){return b.init.apply(this,arguments);}else{c.error("Method "+l+" does not exist on jQuery.prodigal");}}};})(jQuery,window,document);