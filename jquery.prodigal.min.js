(function(b,j,h){var a={width:960,height:600,minWidth:960,minHeight:400,position:"center",fitToView:false,spaceFromEdge:35,overlay:{show:true,opacity:0.4,onclickClose:true},tpl:{overlay:'<div class="prodigal_overlay"></div>',wrapper:'\t\t\t\t<div class="prodigal_wrapper"> \t\t\t\t\t<div class="prodigal_outer"> \t\t\t\t\t\t<div class="prodigal_inner"> </div> \t\t\t\t\t</div> \t\t\t\t</div>',close:'<div class="prodigal_close"><div class="close_button"><div class="close_symbol">Ã—</div><a href="#">Close</a></div></div>',
gallery:'\t\t\t\t<div class="prodigal_gallery_wrapper"> \t\t\t\t\t<div class="prodigal_gallery_left"></div> \t\t\t\t\t<div class="prodigal_gallery_right"></div> \t\t\t\t</div>',sorter:'\t\t\t\t<div class="prodigal_sorter"><select> \t\t\t\t\t<option value="all">All</option> \t\t\t\t\t<option value="images">Images</option> \t\t\t\t\t<option value="videos">Videos</option> \t\t\t\t</select></div>'},thumbs:{width:null,height:55},sources:{youtube:{matcher:/(youtube\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?(videoseries\?list=(.*)|[\w-]{11}|\?listType=(.*)&list=(.*)).*/i,
url:"//www.youtube.com/embed/$3"},vimeo:{matcher:/(?:vimeo(?:pro)?.com)\/(?:[^\d]+)?(\d+)(?:.*)/,url:"//player.vimeo.com/video/$1"}},_overlay:null,_wrapper:null,_media:[],isActive:false,isOpen:false},f={init:function(c){c=b.extend(true,{},a,c);return this.each(function(){data=b(this).data("prodigal");if(!data)b(this).data("prodigal",c).on("click",f.open)})},destroy:function(){return this.each(function(){var c=b(this),d=c.data("prodigal");b(j).unbind(".prodigal");d.tooltip.remove();c.removeData("prodigal")})},
close:function(){if(a._wrapper){a._wrapper.find(".prodigal_gallery_left iframe").remove();a._overlay.remove();a._wrapper.remove();a._overlay=null;a._wrapper=null}a.isActive=false},open:function(c){c.preventDefault();if(a._wrapper!=null||a._overlay!=null)f.close();opts=b.extend(true,{},a,b(this).data("prodigal"));if(a.isActive==false){a._overlay=b(opts.tpl.overlay).css({opacity:opts.overlay.opacity,display:opts.overlay.show?"block":"none"}).appendTo("body");a._wrapper=b(opts.tpl.wrapper).css({}).appendTo("body");
if(opts.overlay.onclickClose)a._overlay.on("click",f.close);var d=b(opts.tpl.close);a._wrapper.find(".prodigal_inner").html("").append(d);d.find(".close_button").on("click",p);d=b(opts.tpl.gallery);d.find(".prodigal_gallery_right").append(b(opts.tpl.sorter).on("change",q));a._wrapper.find(".prodigal_inner").append(d);a._wrapper.data("prodigal",opts);var e=b(c.target);b(h).find(".prodigal-thumbs").each(function(k,i){var g,l=b(i).attr("href"),m=b(i);if(m.find("img").length>0)g=m.find("img").attr("src");
image=b('<div class="image_item"><a class="prodigal_thumb" href="'+l+'"><img src="'+g+'"/></a></div>');image.data("prodigal-media-type","image");b.each(opts.sources,function(t,n){var o=n.matcher.exec(l);if(o!=null){l=r(n.url,o,{});image.find("a").attr("href",l);image.data("prodigal-media-type","video")}});a._wrapper.find(".prodigal_gallery_right").append(image.on("click",s));if(opts.thumbs.width!==null||opts.thumbs.height!==null){g=image.find("img");g.outerWidth();m=g.outerHeight();if(g.outerHeight()>
opts.thumbs.height&&opts.thumbs.height!==null)g.css({height:opts.thumbs.height});else g.outerWidth()>opts.thumbs.width&&m<opts.thumbs.height&&opts.thumbs.width!==null&&g.css({width:gallery_left.width()});g.outerWidth()>opts.thumbs.width&&opts.thumbs.width!==null&&g.css({width:opts.thumbs.width,height:"auto"})}if(e.parents(".prodigal-thumbs").get(0)==b(i).get(0)){image.trigger("click");image.find("a").attr("href")}a._media[k]=image});a._wrapper.find(".prodigal_img_selected").length<=0&&a._wrapper.find(".prodigal_gallery_right .prodigal_thumb").first().trigger("click")}f.resize(false);
a.isActive=true},resize:function(c){if(c==null)c=true;if(a._wrapper){opts=a._wrapper.data("prodigal");var d,e;if(self.pageYOffset){e=self.pageYOffset;d=self.pageXOffset}else if(h.documentElement&&h.documentElement.scrollTop){e=h.documentElement.scrollTop;d=h.documentElement.scrollLeft}else if(h.body){e=h.body.scrollTop;d=h.body.scrollLeft}d=[d,e];a._wrapper.css({top:(d[1]!="undefined"&&d[1]!=null?d[1]:0)+opts.spaceFromEdge,left:(d[0]!="undefined"&&d[0]!=null?d[0]:0)+opts.spaceFromEdge});if(opts.fitToView){a._wrapper.css({width:b(j).width()-
opts.spaceFromEdge*2,height:b(j).height()-opts.spaceFromEdge*2});parseInt(a._wrapper.css("width"))<opts.minWidth&&a._wrapper.css({width:opts.minWidth});parseInt(a._wrapper.css("height"))<opts.minHeight&&a._wrapper.css({height:opts.minHeight})}else{a._wrapper.css({width:opts.width,height:opts.height});switch(opts.position){case "center":a._wrapper.css({left:Math.max(0,(b(j).width()-a._wrapper.outerWidth())/2+b(j).scrollLeft())})}}var k=a._wrapper.outerHeight(),i=a._wrapper.find(".prodigal_close").outerHeight();
d=a._wrapper.find(".prodigal_gallery_left img");e=a._wrapper.find(".prodigal_gallery_left");e.css({height:k-i-(parseInt(e.css("paddingTop"))+parseInt(e.css("paddingBottom"))),lineHeight:k-i+"px",width:a._wrapper.width()-a._wrapper.find(".prodigal_gallery_right").width()-(parseInt(e.css("paddingLeft"))+parseInt(e.css("paddingRight")))});if(c){d.outerWidth();c=d.outerHeight();if(d.outerHeight()>e.height())d.css({height:e.height()});else d.outerWidth()>e.width()&&c<e.height()&&d.css({width:e.width()});
d.outerWidth()>e.width()&&d.css({width:e.width(),height:"auto"});d.css({marginTop:(e.height()-d.outerHeight())/2})}a._wrapper.find(".prodigal_gallery_left iframe").css({height:e.height(),lineHeight:e.height()+"px",width:e.width()})}}},p=function(c){c.preventDefault();f.close()},s=function(c){c.preventDefault();b(".prodigal_img_selected").removeClass("prodigal_img_selected");b(this).addClass("prodigal_img_selected");if(b(this).data("prodigal-media-type")!==null&&b(this).data("prodigal-media-type")==
"video"){c=b('<iframe class="prodigal-iframe" scrolling="auto" frameborder="0" allowfullscreen="" mozallowfullscreen="" \t\t\t\twebkitallowfullscreen="" hspace="0" vspace="0"></iframe>');c.attr("src",b(this).find("a").attr("href"));a._wrapper.find(".prodigal_gallery_left").html("").append(c);f.resize()}else{a._wrapper.find(".prodigal_gallery_left").html("").append(b('<img class="prodigal_large_preview"/>').css({visibility:"hidden"}));a._wrapper.find(".prodigal_large_preview").load(function(){f.resize();
b(this).css({visibility:"visible"})}).attr("src",b(this).find("a").attr("href"))}},q=function(){switch(b(this).find(":selected").val()){case "all":a._wrapper.find(".image_item").css({display:"block"});break;case "images":a._wrapper.find(".image_item").each(function(){b(this).data("prodigal-media-type")=="image"?b(this).css({display:"block"}):b(this).css({display:"none"})});break;case "videos":a._wrapper.find(".image_item").each(function(){b(this).data("prodigal-media-type")=="video"?b(this).css({display:"block"}):
b(this).css({display:"none"})})}},r=function(c,d,e){e=e||"";if(b.type(e)==="object")e=b.param(e,true);b.each(d,function(k,i){c=c.replace("$"+k,i||"")});if(e.length)c+=(c.indexOf("?")>0?"&":"?")+e;return c};b(j).resize(function(){f.resize()});b(h).on("keydown",function(c){a._wrapper!==null&&c.keyCode==27&&f.close()});b.fn.prodigal=function(c){if(f[c])return f[c].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof c==="object"||!c)return f.init.apply(this,arguments);else b.error("Method "+
c+" does not exist on jQuery.prodigal")}})(jQuery,window,document);
